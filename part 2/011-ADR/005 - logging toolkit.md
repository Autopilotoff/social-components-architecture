### Выбор инструментария логирования

#### Контекст:

Для обеспечения наблюдаемости создаваемого приложения предстоит выбрать набор инструментов логированирования.

Будут рассмотрены:
- ELK;
- Graylog Open;
- Grafana Loki.

**ELK**

Особенности: возможность принимать данные в разных форматах и разного размера из большого количества источников с помощью всевозможных входных плагинов; наличие готовых интеграций для популярных сервисов и платформ (дашборды, визуализации и конвейеры для извлечения структурированных полей из лог-сообщений); широкие возможности парсинга именованных полей из строк для аналитики данных; совершенная визуализация данных; возможности расширения.

Минусы: платные корреляция и дедупликация, интеграция с платформами совместной работы и ITSM, алерты.

**Graylog Open**

Особенности: выполняет функции агрегатора логов и инструмента визуализации в виде клиентского одностраничного браузерного приложения; дополнительно использует базу данных mongoDB для хранения конфигураций и настроек; наличие встроенной системы оповещений (алертов); является средством больше для анализа логов.

Минусы: ограниченные возможности расширений и визуализации данных.

**Grafana Loki**

Особенности: является простым и легковесным решением и подходит для решения узких задач, когда не нужна полноценная наблюдаемость (observability) систем и сервисов; всю основную работу делегирует агентам-сборщикам; имеет развитую встроенную систему оповещений (алертов).

Минусы: увеличенное время поиска в случае большого объёма логов (из-за невозможности полнотекстового поиск по индексу).

#### Решение:

Будет использоваться ELK.
ELK-стек является самым полнофункциональным решением по сбору и обработке данных, обладает лучшей (среди рассмотренных инструментов) масштабируемостью, отказоустойчивостью (операционная стабильность достигается ведением логов на каждое изменение данных в хранилище сразу на нескольких узлах кластера), гибкостью поисковых фильтров и универсальностью (Logstash в потоковом режиме работает одновременно со множеством разных источников данных).

#### Статус:

предложен

#### Последствия:

Потребуется увеличенное количество ресурсов для работы ELK (CPU и RAM из-за использования JVM). Вероятно, потребуется освоить поддержкой и аналитиками возможностей инструмента Kibana, внутреннего языка запросов QueryDSL. Стоимость использования Elastic Cloud начинается от 150-170 долларов в месяц.
