# ADR
----------------------------------

### Выбор типа облачных услуг

#### Контекст:

Необходимо выбрать тип облачных услуг, рассмотрены следующие варианты:
- IaaS (Infrastructure as a Service)
- PaaS (Platform as a Service)
- SaaS (Software as a Service)

**IaaS** - предоставление провайдером инфраструктуры (вычислительных мощностей) в аренду.

На стороне облачного провайдера - виртуализация, оборудование, системные инженеры, инфраструктура дата-центра.

На стороне клиента - администрирование ОС, администрирование БД, администрирование приложений, мониторинг, резервное копирование, ПК/ноутбуки и каналы связи, офис (рабочие места и электричество).

Особенности IaaS - можно устанавливать на сервере любые программы, производить любые операции; можно разделять ресурсы на проекты внутри аккаунта и определять правила доступа для разных пользователей; нагрузку между серверами можно распределять равномерно с помощью балансировщиков; файлы и бэкапы можно поместить в облачное хранилище; провайдеры предоставляют сервисы, которые создают резервные копии инфраструктуры и при сбоях автоматически переносят туда нагрузку.

Плюсы IaaS - экономичность (оплата только за потребляемые ресурсы, нет необходимости платить за модернизацию оборудованию и платить специалистам за это); лёгкая масштабируемость (можно регулировать потребление ресурсов автоматически); гибкость (свобода выбора под какие нужды использовать ресурсы).

Минусы IaaS - сложность (нужны специальные знания и навыки); качество работы вашей инфраструктуры зависит от надёжности и добросовестности провайдера.

IaaS подходит, когда есть сильные скачки спроса в определенные периоды времени, а также при необходимости разворачивать отдельные среды для тестирования программ (которые, после использование, можно свернуть).

**PaaS** - предварительно настроенный набор инструментов, который провайдер предоставляет клиентам для создания ими своих приложений.

На стороне облачного провайдера - виртуализация, оборудование, системные инженеры, инфраструктура дата-центра, администрирование ОС, администрирование БД.

На стороне клиента - администрирование приложений, мониторинг, резервное копирование, ПК/ноутбуки и каналы связи, офис (рабочие места и электричество).

Особенности PaaS - на платформе уже есть готовые инструменты для различных нужд клиентов (AI-инструменты, загрузка и обработка данных для ML, инструменты управления и базами данных и их анализа).

Плюсы PaaS - упрощение и удешевление процесса разработки программ; готовые, настроенные инструменты для разработки.

Минусы PaaS - меньшая степень контроля над вычислительной инфраструктурой (в сравнении с IaaS); возможности разработки ограничены тем функционалом, который предлагает провайдер.

**SaaS** - полностью готовые к работе программы, настроенные на решение задач клиента (электронная почта, конструкторы для создания сайтов, CRM-системы, сервисы видеозвонков).

На стороне облачного провайдера - виртуализация, оборудование, системные инженеры, инфраструктура дата-центра, администрирование ОС, администрирование БД, администрирование приложений, мониторинг, резервное копирование.

На стороне клиента -  ПК/ноутбуки и каналы связи, офис (рабочие места и электричество).

SaaS подходит, когда клиенту требуется типовое решение, уже имеющееся на рынке (электронная почта, CRM-система), когда нет смысла и ресурсов разрабатывать свой комплекс программ. Также подходит для краткосрочных проектов.

Плюсы SaaS - готовое решение (не нужно тратить время на разработку и нанимать специалистов); клиент может больше сосредоточиться на решении своих бизнес-задач; для получения доступа к SaaS обычно нужны только браузер и подключение к интернету.

Минусы SaaS - возможности ограничены функционалом программы; работу SaaS контролирует провайдер; ограниченные возможности интеграции с другими приложениями и сервисами.

#### Решение:

Будет использоваться **IaaS**, так как:

- необходимо максимально абстрагироваться от облачного провайдера;
- уже имеется штат специалистов и опыт разработки приложений для облаков;
- требуется гибкость в конфигурации, управлении ресурсами, доступов, настройке отдельных сред разработки.

#### Статус:

предложен

#### Последствия:

После выбора типа облачных услуг IaaS предстоит проанализировать и выбрать средства и инструменты, которые будут использоваться вокруг приложения, которые необходимо подготовить и настроить средствами команды.

----------------------------------

### Выбор языка программирования для iOS-приложения

#### Контекст:

Необходимо выбрать язык программирования для iOS-приложения, будут рассмотрены следующие варианты:
- SWIFT
- Objective-C
- C#
- HTML 5
- Java
- React Native
- Flutter

**SWIFT** - основными преимуществами являются масштабируемость, совместимость, открытый исходный код и быстрая разработка. При создании приложений Swift используются функции ARC и защиты данных (автоматическая дуга памяти). Язык гарантирует быстрый цикл разработки и возможность создания безопасного и надежного кода.

Плюсы SWIFT - проект с открытым исходным кодом; простой в использовании и стабильный; быстро развивающийся процесс; предусмотрен автоматический подсчет памяти (AMC).

Минусы SWIFT - маленькое сообщество.

**Objective-C** - разработан в качестве расширения объектно-ориентированного языка программирования для языка программирования C. В настоящее время является языком программирования общего назначения, который совместим с Mac OS и iOS. До Swift это был основной язык для создания iOS-приложений. 

Особенности Objective-C - отсутствие обновлений, ограниченная функциональность и проблемы с безопасностью снижают его привлекательность. Однако его часто считают надежным и взрослым языком. Последняя версия была выпущена в 2016 году. Но если требуется разработать приложение, доступное для всех, даже в более ранних версиях iOS, которые Swift не поддерживает, то стоит рассмотреть данный язык.

Плюсы Objective-C - язык предлагает динамическую типизацию, зрелость и стабильность. 

Минусы Objective-C - сложно изучить, потому что он недоступен в качестве языка с открытым исходным кодом; обеспечивается низкая безопасность; ограниченная функциональность. 

**C#** - высокоуровневый объектно-ориентированный многоцелевой язык программирования.
Создан для приложений Windows OC, но стало возможным создавать собственное программное обеспечение на этом языке практически для любой платформы, включая iOS, благодаря внедрению .NET framework для Linux и Mac. Данный язык также подходит для разработки  мобильных приложения для пользователей Android.

Плюсы C# - открытый исходный код; автоматическая сборка мусора; разнообразие библиотек; легкая разработка для iOS.

Минусы C# - высокий порог входа при освоении.

**HTML 5** - технология, используемая для создания и демонстрации веб-страниц путем определения значения и структуры их содержимого. Обычно используется разработчиками в сочетании с CSS и JavaScript. Использование таких технологий, как Apache Cordova или Visual Studio для Mac, упрощает создание приложений для iOS.

Особенности HTML 5 - предлагает офлайн-серфинг, кросс-браузерную совместимость, многоплатформенную поддержку, исключительную экономичность и обеспечивает высокий рейтинг страниц. Если есть необходимость быстро создать простое приложение для iOS, которое также можно использовать в автономном режиме, HTML 5 — лучший вариант. Однако это может быть не лучший вариант для качественных и эффективных приложений для iPhone.

Плюсы HTML 5 - рентабельность; обеспечение многоплатформенной поддержки; возможность создавать автономные приложения; возможность обеспечить хорошее ранжирование страницы.

Минусы HTML 5 - нет возможности создавать нативные приложения; ограниченная функциональность; возможны проблемы адаптивного дизайна.

**Java** - язык общего назначения, напоминающий языки, сравнимые с C. iOS также программируется на строго типизированном объектно-ориентированном языке общего назначения. Исходный код Java преобразовывается в Objective-C для платформы iOS (iPhone/iPad). Один из самых популярных языков для создания приложений для Android.

Особенности Java - широкая универсальность для кроссплатформенных приложений. Java не является популярным вариантом для разработки приложений для iOS, несмотря на его повсеместное распространение и универсальность. Однако следует подумать об использовании того же языка программирования для создания версии для iOS, если уже есть мобильное приложение для Android, разработанное на Java.

Плюсы Java - гибкость; открытый исходный код; огромная поддержка сообщества; подходит как для нативной, так и для кроссплатформенной разработки.

Минусы Java - высокий порог входа при освоении; требует значительного объема памяти.

**React Native** - кроссплатформенный язык, представленный Facebook. В настоящее время это одна из самых популярных кроссплатформенных утилит. Позволяет создавать приложения с использованием технологий веб-сайтов с использованием JavaScript.

Особенности React Native - если в команде есть профессионалы JavaScript или React Native, и необходимо одновременно создать мобильное приложение для iOS и Android, React Native — лучший вариант. Выбор этого языка может сэкономить время и деньги, технология надежна, потому что она применяется для наиболее широко используемых приложений для смартфонов в мире.

Плюсы React Native - быстрорастущая популярность; открытый исходный код; обеспечение интерпретации исходного кода и быстрое преобразование его в собственные элементы; быстрый процесс разработки; позволяет разработчикам программного обеспечения писать модули на таких языках программирования, как C, SWIFT и Java.

Минусы React Native - отсутствие некоторых компонентов; проблемы совместимости и отладки.

**Flutter** - полный пакет средств разработки программного обеспечения (SDK) включает в себя инструменты и виджеты, готовые к использованию. Представлен Google. С помощью него возможно легко создавать эстетически привлекательные мобильные, веб-приложения и приложения для настольных ПК, используя единую кодовую базу.

Особенности Flutter - инструмент построен на языке программирования Dart, он будет лучшим вариантом, если члены команды знакомы с ним; если необходимо разработать не только приложение для iOS и Android, но также настольную и онлайн-версию, то стоит рассмотреть данный инструмент.

Плюсы Flutter - быстрый процесс разработки; бесплатный и с открытым исходным кодом; полная настройка и быстрый рендеринг; простота обслуживания и разработки новых функций; требуется только одна кодовая база для iOS и Android приложений; предоставляет свои собственные виджеты для использования.

Минусы Flutter - небольшое количество библиотек; отсутствие стандартного руководства по разработке.

#### Решение:

Будет использоваться язык React Native, так как обеспечивается:
- кроссплатформенность;
- открытый исходный код;
- популярность и сообщество;
- скорость разработки;
- использование нативных элементов смартфонов (удобство для пользователя приложений);
- обширная возможность использования открытых компонентов.

#### Статус:

предложен

#### Последствия:

Возможно, потребуется обучение команды, но порог входа будет низкий для знающих JavaScript. Будет создано приложение для iOS и Android, не потребуется отдельного процесса разработки для еще одной платформы.

----------------------------------

### Выбор языка программирования для Androind-приложения

#### Контекст:

В процессе поиске языка для разработки iOS-приложения были рассмотрены следующие варианты:
- SWIFT
- Objective-C
- C#
- HTML 5
- Java
- React Native
- Flutter

Был выбран универсальный для iOS и Android язык.

#### Решение:

(Скопировано из ADR выбора языка программирования для iOS-приложения)

Будет использоваться язык React Native, так как обеспечивается:
- кроссплатформенность;
- открытый исходный код;
- популярность и сообщество;
- скорость разработки;
- использование нативных элементов смартфонов (удобство для пользователя приложений);
- обширная возможность использования открытых компонентов.

#### Статус:

предложен

#### Последствия:

(Скопировано из ADR выбора языка программирования для iOS-приложения)

Возможно, потребуется обучение команды, но порог входа будет низкий для знающих JavaScript. Будет создано приложение для iOS и Android, не потребуется отдельного процесса разработки для еще одной платформы.

----------------------------------

### Выбор языка программирования для backend-сервисов (микросервисной архитектуры)

#### Контекст:

Необходимо, чтобы язык подходил под следующие требования:
- сокращенная кривая обучения (либо навык использования языка командой);
- простота разработки;
- поддержка архитектуры;
- поддержка автоматизации;
- независимость развертывания;
- непрерывность интеграции;
- зрелость сообщества;
- популярность.

Для выбора будут рассмотрены описанные ниже языки и их фреймворки.

**Go**

Плюсы Go - низкий порог входа (простота синтаксиса, легкость обучения); разнообразие  встроенных инструментов для разработчиков; разнообразие библиотек; высокая производительность и надежность по использованию памяти; развитое сообщество.

Минусы Go - ограниченность функционала (создан для сетевых и серверных приложений); простота (отсутствие объектов, полезных для совместной работы с распределённым кодом).

В языке Go рассмотрены следующие фреймворки:
- Gin - микрофреймворк для разработки REST API. Его выбирают для проектов, требующих повышенной производительности. Фреймворк отличает легковесность, встроенный рендеринг и поддержка промежуточного ПО;
- Beego - полнофункциональный RESTful-фреймворк для быстрой разработки Go-приложений. Спроектирован специально для модульной разработки. В основе его архитектуры несколько слабосвязанных модулей, которые можно использовать по мере необходимости, в том числе независимо от веб-разработки в Beego, например в сетевых играх. Beego подходит для любых приложений и способен обрабатывать большие объемы трафика. Однако для простых REST API стоит использовать легковесные микрофреймворки;
- GoMicro - набор инструментов для создания микросервисов на Go, использующие RPC как основной шаблон обмена сообщениями. «Из коробки» есть обнаружение служб, балансировка нагрузки, встроенные возможности публикации/подписки и кодирование сообщений.

**Node.js**

Node.js — это среда выполнения, использующая движок Google V8 для трансляции JavaScript в машинный код.

Плюсы Node.js - оптимальная скорость работы приложений; возможность совместного и повторного использования; огромное количество бесплатных инструментов; кроссплатформенность; «бесшовная» поддержка JSON.

Минусы Node.js - низкая производительность при работе с тяжёлыми вычислительными задачами; сложность понимания кода из-за зависимости от обратного вызова; незрелость (множество инструментов низкого качество и отсутствие документации на них).

Фреймворки Node.js:
- Koa — это усовершенствование Express (самый популярный веб-фреймворк для приложений). Он полностью использует новейшие функции Node.js, работает без обратных вызовов и имеет мощную систему обработки ошибок. Как и Express, Koa — микрофреймворк, но более легковесный и производительный.
- Nest - платформа для разработки масштабируемых приложений. Его используют, когда есть потребность в более функциональной среде по сравнению с Express и Koa. В Nest большинство этих функций идет «из коробки» (в отличии от других легковесных микрофреймворков).
- LoopBack — это хорошо расширяемый фреймворк на основе Express. В 2019 году отмечен премией API-2019 как лучшее API Middleware-решение. Стоит рассмотреть его, если требуется быстро создать динамические сквозные REST API.

**Java**

Фреймворки Java:
- Spring Boot — это самая зрелая и популярная на текущий момент среда Java для написания микросервисов. Здесь полный набор нужных инструментов, включая обнаружение сервисов, балансировку нагрузки, поддержку Cloud Native, безопасность, интеграцию с инструментами мониторинга и многое другое;
- Dropwizard — фреймворк Dropwizard используется для разработки удобных, высокопроизводительных и Restful веб-сервисов. Без дополнительных настроек поддерживает инструменты конфигурации, метрики приложения, протоколирования и работы;
- Micronaut — full-stack фреймворк на основе JVM для построения модульных, легко тестируемых микросервисных и бессерверных приложений. Создает полнофункциональные микросервисы, включая внедрение зависимостей, автоконфигурацию, обнаружение служб, маршрутизацию HTTP и клиент HTTP. Micronaut стремится избежать недостатков фреймворков Spring, Spring Boot, обеспечивая более быстрое время запуска, уменьшение объема памяти, минимальное использование рефлексии и спокойное юнит-тестирование;
- AxonIQ — событийно-ориентированный фреймворк микросервисов с открытым исходным кодом, сфокусированный на Command Query Responsibility Segregation (CQRS), Domain-Driven Design (DDD) и скоринге событий.

**Python**

Плюсы Python - простота синтаксиса, а значит — низкий порог вхождения; расширяемость и гибкость; интерпретируемость и кроссплатформенность; стандартизированность; открытый исходный код; сильное комьюнити и конференции.

Минусы Python - низкая производительность; динамическая типизация (потребляет много ресурсов и имеет низкую скорость выполнения программы); глобальная блокировка интерпретатора (ограничение параллельности вычислений); синтаксис и семантика (отличаются от остальных языков и создают неудобство опытным разработчикам).

Фреймворки Python:
- Django - зрелый, хорошо документированный, имеет большое сообщество, подходит как для маленьких, так и для больших проектов, так как он хорошо масштабируется, безопасен и достаточно быстр, избыточен для для создания только серверной части REST API;
- Flask - легковеснее и быстрее Django, множество расширений для настройки вариантов хранения, взаимодействия с базой данных, аутентификации и авторизации, безопасности и другого;
- Falcon - микрофреймворк, ориентированный на производительность, ограниченный набор функций, но выше скорость работы по сравнению с Django и Flask;
- FastAPI и Sanic - асинхронные фреймворки, предназначены для повышения производительности в условиях большого количества одновременных подключений, схожий с Flask синтаксис и высокая скорость работы.

**.NET**

Плюсы .NET - обладает высочайшей совместимостью с существующими приложениями и библиотеками; встроенная поддержка внедрения зависимостей; открытый исходный код (для .NET Core); надежная система кеширования; надежная интегрированная среда; кроссплатформенность.

Минусы .NET - стоимость лицензии; разрыв между выпуском и поддержкой (долгое нахождение в режиме ожидания).

Фреймворк .NET Core - является кроссплатформенной, высокопроизводительной средой с открытым исходным кодом для создания современных облачных приложений.
ASP.NET Core позволяет выполнять следующие задачи:
- Создавать веб-приложения и службы, приложения Интернета вещей (IoT) и серверные части для мобильных приложений;
- Использовать избранные средства разработки в Windows, macOS и Linux;
- Выполнять развертывания в облаке или локальной среде.

#### Решение:

Будет использоваться .NET Core, так как обеспечивается:
- кроссплатформенность;
- совершенство наличия необходимых инструментов для разработки микросервисов (нативные интеграции);
- открытый исходный код;
- производительность.

#### Статус:

предложен

#### Последствия:
Создание единой стандартизированной кодовой базы. Если команда использует отличные от .NET Core средства разработки, то потребуется повышение квалификации команды и дополнительное обучение.

----------------------------------

### Выбор инструментария логирования

#### Контекст:

Для обеспечения наблюдаемости создаваемого приложения предстоит выбрать набор инструментов логированирования.

Будут рассмотрены:
- ELK;
- Graylog Open;
- Grafana Loki.

**ELK**

Особенности: возможность принимать данные в разных форматах и разного размера из большого количества источников с помощью всевозможных входных плагинов; наличие готовых интеграций для популярных сервисов и платформ (дашборды, визуализации и конвейеры для извлечения структурированных полей из лог-сообщений); широкие возможности парсинга именованных полей из строк для аналитики данных; совершенная визуализация данных; возможности расширения.

Минусы: платные корреляция и дедупликация, интеграция с платформами совместной работы и ITSM, алерты.

**Graylog Open**

Особенности: выполняет функции агрегатора логов и инструмента визуализации в виде клиентского одностраничного браузерного приложения; дополнительно использует базу данных mongoDB для хранения конфигураций и настроек; наличие встроенной системы оповещений (алертов); является средством больше для анализа логов.

Минусы: ограниченные возможности расширений и визуализации данных.

**Grafana Loki**

Особенности: является простым и легковесным решением и подходит для решения узких задач, когда не нужна полноценная наблюдаемость (observability) систем и сервисов; всю основную работу делегирует агентам-сборщикам; имеет развитую встроенную систему оповещений (алертов).

Минусы: увеличенное время поиска в случае большого объёма логов (из-за невозможности полнотекстового поиск по индексу).

#### Решение:

Будет использоваться ELK.
ELK-стек является самым полнофункциональным решением по сбору и обработке данных, обладает лучшей (среди рассмотренных инструментов) масштабируемостью, отказоустойчивостью (операционная стабильность достигается ведением логов на каждое изменение данных в хранилище сразу на нескольких узлах кластера), гибкостью поисковых фильтров и универсальностью (Logstash в потоковом режиме работает одновременно со множеством разных источников данных).

#### Статус:

предложен

#### Последствия:

Потребуется увеличенное количество ресурсов для работы ELK (CPU и RAM из-за использования JVM). Вероятно, потребуется освоить поддержкой и аналитиками возможностей инструмента Kibana, внутреннего языка запросов QueryDSL. Стоимость использования Elastic Cloud начинается от 150-170 долларов в месяц.